{
  "name": "Fuse",
  "scopeName": "source.fuse",
  "patterns": [
    {"include": "#comments"},
    {"include": "#strings"},
    {"include": "#definitions"},
    {"include": "#fields"},
    {"include": "#functionCalls"},
    {"include": "#errorTypes"},
    {"include": "#keywords"},
    {"include": "#types"},
    {"include": "#userTypes"},
    {"include": "#constants"},
    {"include": "#numbers"},
    {"include": "#memberAccess"}
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-hash.fuse",
          "match": "##.*$"
        },
        {
          "name": "comment.line.number-sign.fuse",
          "match": "#.*$"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.fuse",
          "begin": "\"",
          "end": "\"",
          "beginCaptures": {
            "0": {"name": "punctuation.definition.string.begin.fuse"}
          },
          "endCaptures": {
            "0": {"name": "punctuation.definition.string.end.fuse"}
          },
          "patterns": [
            {
              "name": "constant.character.escape.fuse",
              "match": "\\\\(\\\\|\"|n|r|t)"
            },
            {
              "name": "constant.character.escape.fuse",
              "match": "\\\\."
            },
            {
              "name": "meta.embedded.expression.fuse",
              "begin": "\\$\\{",
              "end": "\\}",
              "beginCaptures": {
                "0": {"name": "punctuation.section.embedded.begin.fuse"}
              },
              "endCaptures": {
                "0": {"name": "punctuation.section.embedded.end.fuse"}
              },
              "patterns": [
                {"include": "#keywords"},
                {"include": "#types"},
                {"include": "#constants"},
                {"include": "#numbers"},
                {"include": "#strings"}
              ]
            }
          ]
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.fuse",
          "match": "\\b(app|service|at|get|post|put|patch|delete|fn|type|enum|let|var|return|if|else|match|case|for|in|while|break|continue|import|from|as|config|migration|table|test|body|and|or|without|spawn|await|box)\\b"
        }
      ]
    },
    "definitions": {
      "patterns": [
        {
          "name": "meta.definition.fuse",
          "match": "^\\s*(fn|type|enum|config|service|app|migration|table|test)\\s+([A-Za-z_][A-Za-z0-9_]*)",
          "captures": {
            "1": {"name": "keyword.control.fuse"},
            "2": {"name": "entity.name.type.fuse"}
          }
        }
      ]
    },
    "fields": {
      "patterns": [
        {
          "name": "meta.field.fuse",
          "match": "^\\s*([a-z_][A-Za-z0-9_]*)\\s*:",
          "captures": {
            "1": {"name": "variable.other.property.fuse"}
          }
        }
      ]
    },
    "functionCalls": {
      "patterns": [
        {
          "name": "meta.function-call.fuse",
          "match": "\\b([a-z_][A-Za-z0-9_]*)\\s*(\\()",
          "captures": {
            "1": {"name": "entity.name.function.fuse"},
            "2": {"name": "punctuation.section.arguments.begin.fuse"}
          }
        }
      ]
    },
    "errorTypes": {
      "patterns": [
        {
          "name": "meta.error-type.fuse",
          "match": "!\\s*([A-Z][A-Za-z0-9_]*)",
          "captures": {
            "0": {"name": "keyword.operator.fuse"},
            "1": {"name": "support.type.error.fuse"}
          }
        }
      ]
    },
    "types": {
      "patterns": [
        {
          "name": "storage.type.fuse",
          "match": "\\b(Int|Float|Bool|String|Id|Email|Bytes|Option|Result|List|Map)\\b"
        }
      ]
    },
    "userTypes": {
      "patterns": [
        {
          "name": "support.type.user.fuse",
          "match": "\\b[A-Z][A-Za-z0-9_]*\\b"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "constant.language.fuse",
          "match": "\\b(true|false|null)\\b"
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.fuse",
          "match": "\\b-?\\d+(?:\\.\\d+)?\\b"
        }
      ]
    },
    "memberAccess": {
      "patterns": [
        {
          "name": "meta.member.fuse",
          "match": "(?<=\\.)[A-Za-z_][A-Za-z0-9_]*",
          "captures": {
            "0": {"name": "variable.other.property.fuse"}
          }
        }
      ]
    }
  }
}
