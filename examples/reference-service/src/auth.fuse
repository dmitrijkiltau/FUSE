import { Unauthorized, Forbidden } from std.Error

type Auth:
  subject: String
  scopes: List<String>

fn require_auth() -> Auth!Unauthorized:
  return Auth(subject="system", scopes=["notes:read", "notes:write"])

fn require_scope(auth: Auth, scope: String) -> Auth!Forbidden:
  match scope:
    "notes:read" -> auth
    "notes:write" -> auth
    _ -> null ?! Forbidden(message="missing scope: ${scope}")
