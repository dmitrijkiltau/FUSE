import { Unauthorized, Forbidden } from std.Error

type Auth:
  subject: String
  scopes: List<String>

fn require_auth() -> Auth!Unauthorized:
  return Auth(subject="system", scopes=["notes:read", "notes:write"])

fn require_scope(auth: Auth, scope: String) -> Auth!Forbidden:
  if scope == "notes:read":
    return auth
  if scope == "notes:write":
    return auth
  null ?! Forbidden(message="missing scope: ${scope}")
